<!-- Main Content -->
<section id="user-header" class="section alt user-header">
  <div class="container">
    <div class="row">
      <div class="span10 offset1">
        <div class="row-fluid header-bubble">
          <div class="span6">
            <div class="row-fluid">
              <div class="span7">
                <% if @user.profiles.present? %> 
                  <a href="#">
                    <div class="profile-pic">  
                    <%= image_tag @user.profiles.image, :"data-toggle" => "modal", :"data-target" => "#photos-modal", :"data-keyboard"=>"true" %>
                    </div>
                  </a>
                  <!-- Photos Modal -->
                  <div id="photos-modal" class="modal hide fade photos-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-body">
                      <div id="photoCarousel" class="carousel slide" data-interval="false">
                        <div class="carousel-inner">
                          <div class="active item"><div class="item-container"><%= image_tag @user.profiles.image %></div></div>
                          <% @user.photos.each_with_index do |photo, counter| %>
                            <div class="item">
                              <div class="item-container"><%= image_tag photo.image %>
                              <div class="row-fluid"><%= photo.description %></div></div>
                            </div> 
                          <% end %>
                        </div>
                        <!-- Carousel nav -->
                        <a class="carousel-control left" href="#photoCarousel" data-slide="prev">&lsaquo;</a>
                        <a class="carousel-control right" href="#photoCarousel" data-slide="next">&rsaquo;</a>
                      </div>
                    </div>
                  </div>
                  <!-- End Photos Modal --> 
                <% end %>
              </div>
              <div class="span5 centered-text details">
                <h3><% if @user.name.present?%><%= @user.name %><% end %></h3>
                <% if @user.location.present? %>
                  <span data-toggle="modal" data-target="#location-modal" data-keyboard="true" class="location-modal-button">
                     <%= @user.location %>
                  </span>
                  <!-- Location Modal -->
                  <div id="location-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-header left-aligned">
                      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                      <h3><span><%= @user.name.split[0..0].join(" ") %></span></h3>
                     <% if @user.location.present? %><p><span><%= @user.location %></span></p> <%end %>
                    </div>
                    <div class="modal-body">
                      <img src="http://maps.googleapis.com/maps/api/staticmap?center=<%= @user.location %>&zoom=11&size=400x300&sensor=false">
                    </div>
                  </div>
                  <!-- End Location Modal --> 
                <%end %>
                <span class="row-fluid talents">
                    <%= if @user.talents.first.present? then @user.talents.first.name end%>
                    
                    <% if @user.talents.second.present? %> 
                    / <%= @user.talents.second.name %> 
                    <% end%>
                </span>
                
                
              </div>
            </div>
          </div>
          <div class="span5 offset1 right-content">
            <div class="row-fluid left-aligned headline">
              <% if @user.headline.present? %>
                 
                <%= shorten :text => @user.headline, :length => 200, :partial => "more_headline" %>
                <!-- Headline Modal -->
                  <div id="headline-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-header left-aligned">
                      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                      <h3><span><%= @user.name.split[0..0].join(" ") %></span></h3>
                    </div>
                    <div class="modal-body">
                      <%= simple_format @user.headline %>  
                    </div>
                  </div>
                  <!-- End Headline Modal --> 
              <% end %>
            </div>
            <div class="row-fluid message-row">
              <div class="span7 offset8 message-span">
                <a data-toggle="modal" data-target="#message-modal" 
                      data-remote ="<%= new_conversation_path(:recipient => @user.email, :modal => true)%>"
                      data-keyboard="true" class="message-button"><%= image_tag('mail_icon.png') %> Message</a>
                <!-- Message Modal -->
                  <div id="message-modal" class="modal hide fade left-aligned" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                      <h3><span>Message <%= @user.name.split[0..0].join(" ") %></span></h3>
                    </div>
                    <div class="modal-body">
                    </div>
                  </div>
                <!-- Message Modal --> 
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section id = "user-body" class="user-body" data-id="<%=@user.id%>">
  <div class="container">
    <div class="row">
      <div class="span10 offset1">
        <div class="row-fluid">
          <div class="span3 follow-container">
            <div class="follow-button">
              <%= render :partial => 'follow_button', :locals => {:user => @user} %>
            </div>
            <div class="follow-images">
              <% @followers_following.first(12).each_with_index do |user, index| %>
                <% if user.profiles.present? %>
                  <%= link_to user do%> <%= image_tag user.profiles.image.url(:tiny) %> <% end %>
                <% end %>
              <% end %>
              <div class="clearfix"></div>
            </div>
            <div class="follow-counts">
              <div class="row-fluid">
                <div class="numbers"><span class="fan-count" data-user-id="<%= @user.id %>"><%= Friendship.where( :friend_id => @user.id).count %></span> Fans</div>
                <div class="numbers"><%= @user.friendships.all.count %> Following</div>
              </div>
            </div>
          </div>
          <div class="span9 about-container">
            <div class="about-title">
              About me:
            </div>  
            <div class="about-content">
              <div><%= shorten :text => @user.about, :length => 300, :partial => "more_about" %></div>
              <!-- About Modal -->
              <div id="about-modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-header left-aligned">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                  <h3><span><%= @user.name.split[0..0].join(" ") %></span></h3>
                </div>
                <div class="modal-body">
                  <%= simple_format @user.about %>  
                </div>
              </div>
              <!-- End Headline Modal --> 
              <%= if not @user.photos.first.nil? then image_tag @user.photos.first.image, :class => "first-pic" end %>
              <%= if not @user.photos.second.nil? then image_tag @user.photos.second.image, :class => "second-pic" end %>
            </div>
          </div>
        </div>
        <div class="row-fluid">
          <div class="span12 links-container">
            <span class="user-menu active" data-link="updates">Updates</span>            
            <span class="user-menu" data-link="reel">Reel</span>            
            <% if @user.talents.first.present? %>
            <span class="user-menu" data-link="first_role"><%= @user.talents.first.name.capitalize %></span>
            <% end %>
            <% if @user.talents.second.present? %>
            <span class="user-menu" data-link="second_role"><%= @user.talents.second.name.capitalize %></span>
            <% end %>
            
            <span class="user-menu" data-link="resume">Resume</span>
          </div>
        </div>
        <div class="row-fluid">
          <div class="span12 body-content-container ">
            
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
